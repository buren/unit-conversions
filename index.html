<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Unit Converter</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Utils -->
  <script src="utils/round-number.js"></script>

  <!-- Converters -->
  <script src="converters/clock.js"></script>
  <script src="converters/distance.js"></script>
  <script src="converters/pace.js"></script>
  <script src="converters/weight.js"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
  <div id="app"></div>

  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.21.0/babel.min.js"></script>
  <script type="text/babel">
    const { useState, useEffect } = React;

    function LbsKgConverter() {
      const defaultValue = "1";
      const defaultUnit = "lbs";

      const [value, setValue] = useState(defaultValue);
      const [unit, setUnit] = useState(defaultUnit);
      const [result, setResult] = useState("-");

      const update = (newValue, newUnit) => {
        const v = newValue === "" ? defaultValue : newValue;
        setValue(v);
        setUnit(newUnit);
        setResult(Weight.convertHuman(v, newUnit));
      };

      useEffect(() => {
        update(value, unit); // set initial
      });

      return (
        <>
          <h2 className="text-2xl font-bold text-gray-800 mb-4">lbs to/from kg</h2>
          <div className="flex items-center space-x-4">
            <input type="number" className="w-20 p-2 border border-gray-300 rounded" placeholder={defaultValue} onChange={(e) => update(e.target.value, unit)} />
            <div className="flex items-center space-x-2">
              <label className="flex items-center space-x-1">
                <input type="radio" name="weight" value="lbs" defaultChecked={unit === "lbs"} onChange={() => update(value, "lbs")} className="accent-blue-500" />
                <span>lbs</span>
              </label>
              <label className="flex items-center space-x-1">
                <input type="radio" name="weight" value="kg" defaultChecked={unit === "kg"} onChange={() => update(value, "kg")} className="accent-blue-500" />
                <span>kg</span>
              </label>
            </div>
          </div>
          <p className="mt-4 text-gray-600">Result: <span className="font-semibold">{result}</span></p>
        </>
      )
    }

    function MilesToKmConverter() {
      const defaultValue = "1";
      const defaultUnit = "miles";

      const [value, setValue] = useState(defaultValue);
      const [unit, setUnit] = useState(defaultUnit);
      const [result, setResult] = useState("-");

      const update = (newValue, newUnit) => {
        const v = newValue === "" ? defaultValue : newValue;
        setValue(v);
        setUnit(newUnit);
        setResult(Distance.convertHuman(v, newUnit));
      };

      useEffect(() => {
        update(value, unit); // set initial
      });

      return (
        <>
          <h2 className="text-2xl font-bold text-gray-800 mb-4">Miles to/from km</h2>
          <div className="flex items-center space-x-4">
            <input type="number" className="w-20 p-2 border border-gray-300 rounded" placeholder={defaultValue} onChange={(e) => update(e.target.value, unit)} />
            <div className="flex items-center space-x-2">
              <label className="flex items-center space-x-1">
                <input type="radio" name="distance" value="miles" defaultChecked={unit === "miles"} onChange={() => update(value, "miles")} className="accent-blue-500" />
                <span>miles</span>
              </label>
              <label className="flex items-center space-x-1">
                <input type="radio" name="distance" value="km" defaultChecked={unit === "km"} onChange={() => update(value, "km")} className="accent-blue-500" />
                <span>km</span>
              </label>
            </div>
          </div>
          <p className="mt-4 text-gray-600">Result: <span className="font-semibold">{result}</span></p>
        </>
      )
    }

    function PaceConverter() {
      const defaultMin = 5;
      const defaultSec = 0;
      const defaultUnit = "min/km";

      const [valueMin, setValueMin] = useState(defaultMin);
      const [valueSec, setValueSec] = useState(defaultSec);
      const [unit, setUnit] = useState(defaultUnit);
      const [result, setResult] = useState("-");
      const [paceTable, setPaceTable] = useState([]);
      const [additionalDistance, setAdditionalDistance] = useState(null);

      const update = (newValueMin, newValueSec, newUnit, newAdditionalDistance) => {
        const ad = newAdditionalDistance === undefined ? additionalDistance : newAdditionalDistance;
        const vMin = parseInt(newValueMin === "" ? defaultMin : newValueMin);
        const vSec = parseInt(newValueSec === "" ? defaultSec : newValueSec);
        setValueMin(vMin);
        setValueSec(vSec);
        setUnit(newUnit);
        setResult(Pace.convertHuman(vMin, vSec, newUnit));
        setPaceTable(Pace.paceTable(vMin, vSec, newUnit, ad ? [ad] : []));
      };

      useEffect(() => {
        update(valueMin, valueSec, unit); // set initial
      }, []);

      return (
        <>
          <h2 className="text-2xl font-bold text-gray-800 mb-4">Pace</h2>
          <div className="flex items-center space-x-4">
            <div className="flex space-x-2">
              <input type="number" className="w-16 p-2 border border-gray-300 rounded" min="0" placeholder={defaultMin} onChange={(e) => update(e.target.value, valueSec, unit)} />
              <span className="pt-[7px]">:</span>
              <input type="number" className="w-16 p-2 border border-gray-300 rounded" min="0" placeholder={defaultSec} onChange={(e) => update(valueMin, e.target.value, unit)} />
            </div>
            <div className="flex items-center space-x-2">
              <label className="flex items-center space-x-1">
                <input type="radio" name="pace" value="min/mile" defaultChecked={unit === "min/mile"} onChange={() => update(valueMin, valueSec, "min/mile")} className="accent-blue-500" />
                <span>min/mile</span>
              </label>
              <label className="flex items-center space-x-1">
                <input type="radio" name="pace" value="min/km" defaultChecked={unit === "min/km"} onChange={() => update(valueMin, valueSec, "min/km")} className="accent-blue-500" />
                <span>min/km</span>
              </label>
            </div>
          </div>
          <p className="mt-4 text-gray-600">Result: <span className="font-semibold">{result}</span></p>

          <div className="overflow-x-auto bg-white shadow-md rounded-lg mt-8">
            <table className="min-w-full border-collapse text-left text-sm">
            <thead className="bg-gray-200">
                <tr>
                <th className="px-6 py-3 font-bold text-gray-700 uppercase">Distance</th>
                <th className="px-6 py-3 font-bold text-gray-700 uppercase">Time</th>
                </tr>
            </thead>
            <tbody className="divide-y divide-gray-300">
                {paceTable.map(([km, time], index) =>
                    <tr className={index % 2 === 0 ? "bg-white" : "bg-gray-50"} key={index}>
                        <td className="px-6 py-3 text-gray-900">{roundNumber(km, 0)}k</td>
                        <td className="px-6 py-3 text-gray-900">{time}</td>
                    </tr>
                )}
            </tbody>
            </table>
          </div>

          <div className="flex items-center space-x-4 mt-2">
                <input
                    type="number"
                    className="w-full p-2 border border-gray-300 rounded"
                    placeholder="Additional distance (km)"
                    onChange={(e) => {
                        update(valueMin, valueSec, unit, parseInt(e.target.value));
                    }}
                />
            </div>
        </>
      );
    }

    function UnitConverter() {
      return (
        <>
          <div className="bg-white p-8 shadow-md rounded-lg w-full min-w-48 max-w-lg">
            <section className="mb-8">
              <PaceConverter />
            </section>

            <hr className="pb-8" />

            <section className="mb-8">
              <LbsKgConverter />
            </section>

            <hr className="pb-8" />

            <section className="mb-8">
              <MilesToKmConverter />
            </section>
         </div>
        </>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('app'));
    root.render(<UnitConverter />);
  </script>
</body>
</html>